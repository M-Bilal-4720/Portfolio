trigger:
  - dev  # Trigger on push to main branch

pool:
  name: Default  # Make sure this matches your self-hosted agent pool name

variables:
  DEPLOY_PATH: "/var/www/your_domain/Portfolio-dev"

steps:
  - script: |
      echo "ğŸš€ Starting Deployment"
      cd /var/www/your_domain/Portfolio-dev
      
      echo "ğŸ” Marking repo as safe"
      git config --global --add safe.directory /var/www/your_domain/Portfolio-dev
      
      echo "ğŸ”„ Resetting local changes"
      git reset --hard
      
      echo "â¬‡ï¸ Pulling latest code"
      git pull --rebase origin dev
      
      echo "âœ… Code pulled successfully"
    displayName: "ğŸ“¥ Pull Latest Code Successfully"
  - script: |
      echo "ğŸ³ Building Docker image"
      sudo docker build -t portfolio-site .

      echo "ğŸ›‘ Stopping and removing existing container (if any)"
      sudo docker stop portfolio-site || true
      sudo docker rm portfolio-site || true

      echo "ğŸš€ Running Docker container"
      sudo docker run -d -p 8085:80 --name portfolio-site portfolio-site
    displayName: "ğŸ³ Build and Run Docker Container"


